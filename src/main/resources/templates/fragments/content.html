<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head></head>
<body>
    <div th:fragment="settlements" th:align="center">
        <table class="table table-hover table-bordered">
            <thead class="thead-light">
            <tr>
                <th scope="col">#</th>
                <th scope="col">Kto stworzył</th>
                <th scope="col">Ile</th>
                <th scope="col">Co</th>
                <th scope="col">Kiedy</th>
                <th scope="col">Pokaż opłaty </th>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${settlements.empty}">
                <td colspan="4">Brak rozliczeń</td>
            </tr>
            <tr th:each="stl : ${settlements}" th:id="@{tr-} + ${stl.id}">
                <th scope="row" th:text="${stl.id}"></th>
                <td th:text="${stl.resident.email}"></td>
                <td th:text="${stl.amount}"></td>
                <td th:text="${stl.type.name}"></td>
                <td th:text="${stl.date}"></td>

                <td th:id="@{td-} + ${stl.id}">
                    <span class="fas-stack fa-lg" onclick="showPayments(this)" th:id="${stl.id}">
                        <i class="fas fa-arrow-down"></i>
                    </span>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <div th:fragment="settled" th:align="center">
        <table class="table table-hover table-bordered">
            <thead class="thead-light">
            <tr>
                <th>ID</th>
                <th>Kto</th>
                <th>Ile</th>
                <th>Co</th>
                <th>Kiedy</th>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${settled.empty}">
                <td colspan="4">Brak rozliczonych</td>
            </tr>
            <tr th:each="stl : ${settled}">
                <td th:text="${stl.id}"></td>
                <td th:text="${stl.resident.email}"></td>
                <td th:text="${stl.amount}"></td>
                <td th:text="${stl.type.name}"></td>
                <td th:text="${stl.date}"></td>
            </tr>
            </tbody>
        </table>
    </div>

    <div th:fragment="payments" th:align="center">
        <table class="table table-hover table-bordered">
            <thead class="thead-light">
            <tr>
                <th>Numer wydatku</th>
                <th>Kwota</th>
                <th>Status</th>
                <th>Dzień opłaty</th>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${payments.empty}">
                <td colspan="4">Brak opłaconych wydatków</td>
            </tr>
            <tr th:each="p : ${payments}" th:id="${p.id.residentId} + '-' + ${p.id.settlementId}">
                <td th:text="${p.id.settlementId}"></td>
                <td th:text="${p.amount}"></td>
                <td th:text="${p.status}"></td>
                <td th:text="${p.date}"></td>
            </tr>
            </tbody>
        </table>
    </div>

    <div th:fragment="to-pay" th:align="center">
        <table class="table table-hover table-bordered">
            <thead class="thead-light">
            <tr>
                <th>Numer wydatku</th>
                <th>Kwota</th>
                <th>Status</th>
                <th></th>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${toPay.empty}">
                <td colspan="4">Wszystkie opłaty rozliczone</td>
            </tr>
            <tr th:each="p : ${toPay}" th:id="'tr-' + ${p.id.residentId} + '-' + ${p.id.settlementId}">
                <td th:text="${p.id.settlementId}"></td>
                <td th:text="${p.amount}"></td>
                <td th:text="${p.status}"></td>
                <td th:id="'td-' + ${p.id.residentId} + '-' + ${p.id.settlementId}" th:switch="${p.status.name()}">
                    <span 
                        th:case="Nierozliczona"
                        class="fas-stack fa-lg"
                        onclick="pay(this)"
                        th:id="${p.id.residentId} + '-' + ${p.id.settlementId}">
                        <i class="fas fa-money-bill-wave"></i>
                    </span>
                    <span th:case="*"></span>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <div th:fragment="to-pay-settlements" th:align="center">
        <table class="table table-hover table-bordered">
            <thead class="thead-light">
            <tr>
                <th scope="col">#</th>
                <th scope="col">Kto stworzył</th>
                <th scope="col">Ile</th>
                <th scope="col">Za co</th>
                <th scope="col">Kiedy</th>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${settlements.empty}">
                <td colspan="4">Brak rozliczeń</td>
            </tr>
            <tr th:each="s : ${settlements}" th:id="@{tr-} + ${stl.id}">
                <th scope="row" th:text="${stl.id}"></th>
                <td th:text="${s.resident.email}"></td>
                <td th:text="${s.amount}"></td>
                <td th:text="${s.type.name}"></td>
                <td th:text="${s.date}"></td>

                <td th:id="@{td-} + ${stl.id}" colspan="5">
                    <table class="table table-hover table-bordered">
                        <thead class="thead-light">
                    <span class="fas-stack fa-lg" onclick="showPayments(this)" th:id="${stl.id}">
                        <i class="fas fa-arrow-down"></i>
                    </span>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
    
    <div th:fragment="add-settlement">
        <form class="needs-validation" action="#" th:action="@{add}" th:object="${stl}" method="post">
            <div class="form-row">
              <div class="col-md-3 mb-3">
                <label for="validationCustom01">Typ rozliczenia</label>
                <select class="custom-select"
                    id="validationCustom01" required
                    th:field="${typeId.value}"
                >
                  <option selected disabled value="">Wybierz...</option>
                  <option th:each="type : ${stlTypes}" th:value="${type.id}" th:utext="${type.name}"/>
                </select>
                <div class="invalid-feedback">
                  Wybierz typ rozliczenia
                </div>
              </div>
              <div class="col-md-3 mb-3">
                <label for="validationCustom02">Data powstania rozliczenia</label>
                <input th:field="${stl.date}" type="date" class="form-control" id="validationCustom02" required>
                <div class="invalid-feedback">
                  Wprowadź datę
                </div>
              </div>
              <div class="col-md-3 mb-3">
                <label for="validationCustom03">Cała kwota rozliczenia</label>
                <input th:field="${stl.amount}" type="number" class="form-control" min="0.00" max="1000.00" step="0.01" required/>
                <div class="invalid-feedback">
                  Wprowadź kwotę
                </div>
              </div>
            </div>
            <button type="submit" class="btn btn-primary">Dodaj</button>
        </form>
    </div>
</body>
</html>

