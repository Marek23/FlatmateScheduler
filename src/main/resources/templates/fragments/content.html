<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head></head>
<body>
    <div th:fragment="settlements" th:align="center">
        <table class="table table-bordered table-striped">
            <thead>
            <tr>
                <td>ID</td>
                <td>Kto</td>
                <td>Ile</td>
                <td>Co</td>
                <td>Kiedy</td>

                <td>Pokaż opłaty </td>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${settlements.empty}">
                <td colspan="4">Brak rozliczeń</td>
            </tr>
            <tr th:each="stl : ${settlements}" th:id="@{tr-} + ${stl.id}">
                <td th:text="${stl.id}"></td>
                <td th:text="${stl.resident.email}"></td>
                <td th:text="${stl.amount}"></td>
                <td th:text="${stl.type.name}"></td>
                <td th:text="${stl.date}"></td>

                <td th:id="@{td-} + ${stl.id}">
                    <span class="fas-stack fa-lg" onclick="showPayments(this)" th:id="${stl.id}">
                        <i class="fas fa-arrow-down"></i>
                    </span>
                </td>
            </tr>
            </tbody>
        </table>
        <div sec:authorize="hasRole('ROLE_ROOMOWNER_')">
            Dodaj wydatek
            <form action="#" th:action="@{add}" th:object="${stl}" method="post">
                <p>Data  wydatku: <input type="text"   th:field="${stl.date}" /></p>
                <p>Kwota wydatku: <input type="number" th:field="${stl.amount}" /></p>
                <p>
                    Typ wydatku
                    <select  th:field="${typeId.value}" >
                        <option th:each="type : ${stlTypes}" th:value="${type.id}" th:utext="${type.name}"/>
                    </select>
                </p>

                <p><input type="submit" value="Zapisz" /> <input type="reset" value="Wyczyść" /></p>
            </form>
        </div>
    </div>

    <div th:fragment="settled" th:align="center">
        <table class="table table-bordered table-striped">
            <thead>
            <tr>
                <td>ID</td>
                <td>Kto</td>
                <td>Ile</td>
                <td>Co</td>
                <td>Kiedy</td>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${settled.empty}">
                <td colspan="4">Brak rozliczonych</td>
            </tr>
            <tr th:each="stl : ${settled}">
                <td th:text="${stl.id}"></td>
                <td th:text="${stl.resident.email}"></td>
                <td th:text="${stl.amount}"></td>
                <td th:text="${stl.type.name}"></td>
                <td th:text="${stl.date}"></td>
            </tr>
            </tbody>
        </table>
    </div>

    <div th:fragment="payments" th:align="center">
        <table class="table table-bordered table-striped">
            <thead>
            <tr>
                <td>Numer wydatku</td>
                <td>Kwota</td>
                <td>Status</td>
                <td>Dzień opłaty</td>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${payments.empty}">
                <td colspan="4">Brak opłaconych wydatków</td>
            </tr>
            <tr th:each="p : ${payments}" th:id="${p.id.residentId} + '-' + ${p.id.settlementId}">
                <td th:text="${p.id.settlementId}"></td>
                <td th:text="${p.amount}"></td>
                <td th:text="${p.status}"></td>
                <td th:text="${p.date}"></td>
            </tr>
            </tbody>
        </table>
    </div>

    <div th:fragment="to-pay" th:align="center">
        <table class="table table-bordered table-striped">
            <thead>
            <tr>
                <td>Numer wydatku</td>
                <td>Kwota</td>
                <td>Status</td>
                <td></td>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${toPay.empty}">
                <td colspan="4">Wszystkie opłaty rozliczone</td>
            </tr>
            <tr th:each="p : ${toPay}" th:id="'tr-' + ${p.id.residentId} + '-' + ${p.id.settlementId}">
                <td th:text="${p.id.settlementId}"></td>
                <td th:text="${p.amount}"></td>
                <td th:text="${p.status}"></td>
                <td th:id="'td-' + ${p.id.residentId} + '-' + ${p.id.settlementId}" th:switch="${p.status.name()}">
                    <span 
                        th:case="Nierozliczona"
                        class="fas-stack fa-lg"
                        onclick="pay(this)"
                        th:id="${p.id.residentId} + '-' + ${p.id.settlementId}">
                        <i class="fas fa-money-bill-wave"></i>
                    </span>
                    <span th:case="*"></span>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</body>
</html>

